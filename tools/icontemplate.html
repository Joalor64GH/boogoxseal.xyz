<!DOCTYPE html>
<html lang="en" style="background-color:rgb(17, 5, 29) ;">
<head>
	<title>Icon Template Generator and Builder - BOOGO x SEAL</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Boogo and Seal make Incredibox Mods and Tools.">
	<link rel="apple-touch-icon" sizes="180x180" href="../icons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="../icons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="../icons/favicon-16x16.png">
	<link rel="manifest" href="../icons/site.webmanifest">
	<link rel="shortcut icon" href="../icons/favicon.ico">
	<meta name="msapplication-TileColor" content="#603cba">
	<meta name="msapplication-config" content="../icons/browserconfig.xml">
	<meta name="theme-color" content="#ffffff">
	<meta charset="UTF-8">
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="BOOGO x SEAL">
	<meta property="og:title" content="Icon Template Generator and Builder" />
	    <meta property="og:image" content="https://boogoxseal.xyz/assets/banner.png" />
    <meta property="twitter:image:src" content="https://boogoxseal.xyz/assets/banner.png" />
	<meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="Boogo and Seal make Incredibox Mods and Tools.">
    <meta name="og:image:alt" content="Boogo and Seal make Incredibox Mods and Tools.">
    <meta name="og:description" content="Boogo and Seal make Incredibox Mods and Tools.">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/topnav.css">
    <link rel="stylesheet" href="../css/overlay.css">
    <script src="../assets/general-functions.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/mdbassit/Coloris@latest/dist/coloris.min.css"/>
    <script src="https://cdn.jsdelivr.net/gh/mdbassit/Coloris@latest/dist/coloris.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js" integrity="sha512-XMVd28F1oH/O71fzwBnV7HucLxVwtxf26XV8P4wPk26EDxuGZ91N8bsOttmnomcCD3CS5ZMRL50H0GgOHvegtg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        td{text-align:center}.th-custom{overflow:auto;font-weight:200;text-align:center;padding-left:5px;padding-right:5px;font-size:28px;margin:10px}body{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:#fff;overflow:auto;font-family:monospace;font-weight:500;margin-top:15vh}
    </style>
</head>



<body style="background-color:rgb(17, 5, 29) ;">
    <div id="overlay" class="text-center visually-hidden">
        <img width="15%" class="position-absolute top-50 start-50 translate-middle" src="../assets/loading.gif"/>
    </div>
    <div class="topnav">
		<a href="../">Home</a>
		<a class="active" href="./">Tools</a>
		<a href="../mods">Mods</a>
		<a href="../about">About Us</a>
		<a href="https://sealldeveloper.github.io/incredibox-downloads-index/">Mod Index</a>
	  </div>
	<div class="container mt-3" style="background-color:rgb(29, 8, 49) ; overflow:hidden;	padding-bottom:40px;height:100%;" >
		<h1 class="m-4 mt-3">Incredibox 'Icon Template' Generator</h1>
        <div id="form">
            <h3 class="m-3">Options</h3>
            <div class="form-group col-md-5 m-3">
                <label for="iconcount">Icon Count</label>
                <input class="form-control" type="number" id="iconcount" placeholder="9" required="true" value="9"></input>
            </div>
            <div class="form-group m-4 mt-4" id="submit">
                <input class="btn btn-primary" type="submit" value="Submit and Generate Template" id="submission"></input>
            </div>
            <h3 class="m-3">Preview</h3>
            <div class="form-group col-md-5 m-3">
                <small style="color:darkcyan">NOTE: Scrollable!</small>
                <br><br>
                <div style="overflow-x: auto;">
                    <canvas id="render" height="152"></canvas>
                </div>
                <div class="visually-hidden">
                    <canvas id="render-hd" height="304"></canvas>
                </div>
            </div>
        </div>
        <br>
        <hr>
        <br>
        <h1 class="m-4 mt-3">Incredibox 'Icon' Builder</h1>
        <div id="buildform">
            <h3 class="m-3">Options</h3>
            <div class="form-group col-md-5 m-3">
                <label for="iconcountbuild">Icon Count</label>
                <input class="form-control" type="number" id="iconcountbuild" placeholder="9" required="true" value="9"></input>
            </div>
            <div class="form-group col-md-5 m-3" id="iconsection">
                <label for="iconcountbuild">Icons</label>
                <br>
                <div class="container-fluid" id="icons">
                </div>
            </div>
            <div class="form-group m-4 mt-4" id="submit">
                <input class="btn btn-primary" type="submit" value="Submit and Generate" id="submissionbuild"></input>
            </div>
            <h3 class="m-3">Preview</h3>
            <div class="form-group m-3">
                <small style="color:darkcyan">NOTE: Scrollable!</small>
                <br>
                <small style="color:coral">NOTE: These previews can have delay/lag, submitting them will update them and download your results.</small>
                <br><br>
                <div style="overflow-x: auto;">
                    <canvas id="buildrender" height="152"></canvas>
                </div>
                <div class="visually-hidden">
                    <canvas id="buildrender-hd" height="304"></canvas>
                    <canvas id="tempcanvas"></canvas>
                </div>
            </div>
        </div>
	</div>
    <script>
        generatedelay=0
        currentlyrunningbuild=0
        submissioncheck=false
        function roundedCorners(ctx,x,y,radius,width,height) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
            ctx.clip()
        }
        async function LoadImageFromDisk(input,r,type) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.readAsDataURL(input.files[0]);
                exit_icon = ""
                reader.onload = function (e) {
                    img = reader.result;
                    elementid = (type === "icon") ? `#iconimg${r}` : `#iconimgtext${r}`
                    $(elementid).attr('src',img)
                    exit_icon = $(elementid)[0]
                    return
                };
                await waitFor( _ => exit_icon !== "")
                return exit_icon
            }
        }

        function initCanvases(canvasname,iconCount,modifier) {
            var canvas = document.getElementById(canvasname)
            var ctx = canvas.getContext('2d')
            $('#'+canvasname).attr('width',((130*8)*modifier)-(10*modifier))
            $('#'+canvasname).attr('height',152*modifier)
            return ctx
        }
        
        async function iconBuild(canvasname, modifier) {
            currentlyrunningbuild++
            var iconCount = Number($('#iconcountbuild').val())
            var prevCount = Number($("#icons").children().length)
            var newadjustment= iconCount-prevCount
            var icons = (newadjustment < 0) ? makeArray(-newadjustment) : ((newadjustment > 0) ? makeArray(newadjustment) : 0)
            ctx = initCanvases(canvasname,iconCount,modifier)
            classes=$('#iconsection').attr("class").split(/\s+/)
            newclasses = (iconCount === 0) ? classes.push('visually-hidden') : classes.pop()
            $('#iconsection').attr("class",classes.join(/\s+/))

            if (newadjustment > 0) {
                for (var r in icons){
                    r=Number(r)+1+prevCount
                    $('#icons').append(`<div class="form-group col-md-5 m-3 iconinputs"><label for="icon${r}">Icon ${r}</label><input class="form-control" type="file" id="icon${r}" accept="image"></input><label for="icontext${r}">Icon Text ${r}</label><input class="form-control" type="file" id="icontext${r}" accept="image"></input><div class="visually-hidden" id="iconimg${r}-div" required="true"><img src="" id="iconimg${r}"/><img src="" id="iconimgtext${r}"/></div></div>`)
                }
            } else if (newadjustment < 0) {
                for (var r in icons) {
                    $('#icons').children().last().remove()
                }
            }
            var newCount = $("#icons").children().length
            var iconUploads = makeArray(newCount)
            ms=120*modifier
            if (iconUploads.length > 0) {
                for (r in iconUploads) {
                    r = Number(r)+1
                    x = ms*(r-1)+((r-1)*10)
                    iconimg = ($(`#icon${r}`).val() !== "") ? await LoadImageFromDisk($(`#icon${r}`)[0],r,'icon') : undefined
                    textimg = ($(`#icontext${r}`).val() !== "") ? await LoadImageFromDisk($(`#icontext${r}`)[0],r,'text') : undefined
                    if (iconimg !== undefined) {
                        ctx.save();
                        roundedCorners(ctx,x,0,35,ms,ms)
                        ctx.drawImage(iconimg,0,0,iconimg.width,iconimg.height,x,0,ms,ms);
                        ctx.restore();
                    }
                    if (textimg !== undefined) {
                        ctx.drawImage(textimg,0,0,textimg.width,textimg.height,x,126*modifier,ms,26*modifier);
                    }
                }
            }
            currentlyrunningbuild--
            generatedelay += submissioncheck ? 2 : 1
            return
            
        }
        function generate(input) {
            var cozette = new FontFace('CozetteVector', 'url(../assets/CozetteVector.otf)');
            cozette.load().then(async function(font){
                document.fonts.add(font);
                if (input === 'build') {
                    if (currentlyrunningbuild <= 0){
                        $('#submissionbuild').prop('disabled',true)
                        generatedelay=0
                        await iconBuild('buildrender',1)
                        await iconBuild('buildrender-hd',2)
                        await waitFor(_ => generatedelay === 2)
                        $('#submissionbuild').prop('disabled',false)
                    }
                } else if (input === 'template') {
                    iconRender('render',1)
                    iconRender('render-hd',2)
                }
            })
        }
        function iconRender(cname,modifier) {
            var canvas = document.getElementById(cname)
            var cozette = new FontFace('CozetteVector', 'url(../assets/CozetteVector.otf)');
            var ctx = canvas.getContext('2d')
            cozette.load().then(function(font){
                document.fonts.add(font);
                var iconCount = Number($('#iconcount').val())
                width=(130*iconCount)-10
                height=152*modifier
                $(`#${cname}`).attr('width',width*modifier)
                $(`#${cname}`).attr('height',height)
                // Icons
                icons=makeArray(iconCount)
                count=0
                currentIconPosX=0
                for (i in icons) {
                    count++
                    isize=120*modifier
                    textsize=15*modifier
                    drawLabelledBox(ctx,'red',currentIconPosX,0,isize,isize,currentIconPosX,12*modifier,'asset-v'+count+' Icon',textsize)
                    drawLabelledBox(ctx,'lime',currentIconPosX,126*modifier,isize,152*modifier,currentIconPosX,138*modifier,'asset-v'+count+' Text',textsize)
                    currentIconPosX+=130*modifier
                }
            })
        }
        $('#form').on('change', function(){
            generate('template')
        })
        $('#buildform').on('change', function(){
            generate('build')
        })
        generate('template')
        generate('build')
        function download(uri, name) {
            var link = document.createElement("a");
            link.download = name;
            link.href = uri;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            delete link;
        }
        $('#submission').on('click', function(){
            var zip = new JSZip();
            generate('template')
            zip.file(`icon-template.png`, zipImg('render'), {base64:true})
            zip.file(`icon-hd-template.png`, zipImg('render-hd'), {base64:true})
            zip.generateAsync({type:"base64"}).then(function (base64) {
                window.open("data:application/zip;base64," + base64,'_blank')
            });
        })
        $('#submissionbuild').on('click', async function(){
            overlayShow()
            submissioncheck=true
            await generate('build')
            await waitFor(_ => generatedelay === 4)
            var zip = new JSZip();
            zip.file(`switch-bt.png`, zipImg('buildrender'), {base64:true})
            zip.file(`switch-bt-hd.png`, zipImg('buildrender-hd'), {base64:true})
            zip.generateAsync({type:"base64"}).then(function (base64) {
                window.open("data:application/zip;base64," + base64,'_blank')
            });
            submissioncheck=false
            overlayHide()
        })
    </script>
    <h3 style="padding-bottom:5px"></h3>
    <h3 style="text-align:center;font-size:10px">Made by <a style="font-size:10px"target="_blank" rel="noopener noreferrer" class="enter">seal</a></h3>
</body>
</html>
